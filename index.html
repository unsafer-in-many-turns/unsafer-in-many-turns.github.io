<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>MT-AgentRisk / ToolShield</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet"/>
  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body { font-family:'Inter',sans-serif; color:#222; line-height:1.6; }
    a { color:#1a6dd4; text-decoration:none; }
    a:hover { text-decoration:underline; }

    .container { max-width:860px; margin:0 auto; padding:0 24px; }

    /* Hero */
    .hero { text-align:center; padding:80px 24px 50px; background:#1a1a2e; color:#fff; }
    .hero h1 { font-size:2.8rem; margin-bottom:16px; line-height:1.2; }
    .hero .subtitle { font-size:1.25rem; color:#ccc; margin-bottom:32px; max-width:900px; margin-left:auto; margin-right:auto; }
    .hero .authors { font-size:1.05rem; color:#ddd; margin-bottom:12px; line-height:1.8; }
    .hero .authors sup { font-size:0.75em; color:#aaa; }
    .hero .affiliations { font-size:0.95rem; color:#aaa; margin-bottom:32px; line-height:1.8; }
    .badges { display:flex; gap:12px; justify-content:center; flex-wrap:wrap; }
    .badge { display:inline-flex; align-items:center; gap:6px; background:#2a2a4a; color:#fff; padding:8px 16px; border-radius:6px; font-size:0.9rem; }
    .badge:hover { background:#3a3a5a; text-decoration:none; }

    /* Sections */
    section { padding:48px 0; }
    section.tint { background:#f7f8fa; }
    h2 { font-size:1.5rem; margin-bottom:12px; }
    .lede { color:#555; margin-bottom:24px; }

    /* Figures */
    figure { margin:32px auto; max-width:100%; }
    figure img {
      width:100%;
      max-width:800px;
      margin:0 auto;
      display:block;
      border:1px solid #e0e0e0;
      border-radius:4px;
      box-shadow:0 2px 8px rgba(0,0,0,0.08);
      image-rendering: -webkit-optimize-contrast;
      image-rendering: crisp-edges;
    }
    figcaption { font-size:0.85rem; color:#666; margin-top:10px; text-align:center; max-width:800px; margin-left:auto; margin-right:auto; }

    /* Two column figures */
    .two-col { display:grid; grid-template-columns:1fr 1fr; gap:24px; margin:32px 0; }
    .two-col figure { margin:0; }
    .two-col figure img { max-width:100%; }
    @media(max-width:768px){ .two-col { grid-template-columns:1fr; gap:32px; } }

    /* Table */
    table { width:100%; border-collapse:collapse; margin:16px 0; font-size:0.9rem; }
    th, td { padding:8px 12px; border:1px solid #ddd; text-align:center; }
    th { background:#f0f0f0; font-weight:600; }
    td:first-child { text-align:left; }
    .row-ours { background:#e8f4fd; font-weight:600; }
    .yes { color:#16a34a; }
    .no { color:#dc2626; }

    /* Key findings */
    .findings { margin:20px 0; }
    .findings p { margin-bottom:8px; padding-left:16px; border-left:3px solid #1a6dd4; }

    /* Steps */
    ol.steps { padding-left:20px; margin:16px 0; }
    ol.steps li { margin-bottom:6px; }

    /* Dimension list */
    .dim { margin:8px 0; }
    .dim strong { display:inline-block; width:70px; }

    /* Stats row */
    .stats-row { display:flex; gap:24px; flex-wrap:wrap; margin:20px 0; }
    .stat { text-align:center; flex:1; min-width:120px; }
    .stat .val { font-size:1.8rem; font-weight:700; color:#1a6dd4; }
    .stat .label { font-size:0.85rem; color:#666; }

    /* BibTeX */
    pre.bib { background:#f0f0f0; padding:16px; border-radius:6px; font-size:0.8rem; overflow-x:auto; white-space:pre-wrap; }

    /* Tools Grid */
    .tools-grid { display:grid; grid-template-columns:repeat(auto-fit, minmax(180px, 1fr)); gap:20px; margin:24px 0; }
    .tool-card { background:#fff; border:1px solid #e0e0e0; border-radius:8px; padding:20px; text-align:center; transition:box-shadow 0.2s; }
    .tool-card:hover { box-shadow:0 4px 12px rgba(0,0,0,0.1); }
    .tool-card .icon { font-size:2.5rem; margin-bottom:12px; }
    .tool-card .name { font-weight:600; font-size:0.95rem; margin-bottom:8px; color:#222; }
    .tool-card .source { font-size:0.8rem; color:#666; margin-bottom:6px; }
    .tool-card .count { font-size:0.85rem; color:#1a6dd4; font-weight:600; }

    /* Image size variants */
    img.img-large { max-width:1000px !important; }
    img.img-medium { max-width:700px !important; }
    img.img-small { max-width:500px !important; }

    /* Case Study */
    .case-study-img {
      max-width:950px !important;
      margin:0 auto;
      display:block;
      box-shadow:0 2px 12px rgba(0,0,0,0.1);
      image-rendering: -webkit-optimize-contrast;
      image-rendering: crisp-edges;
    }

    /* Footer */
    footer { text-align:center; padding:24px; color:#999; font-size:0.85rem; border-top:1px solid #eee; }
  </style>
</head>
<body>

<!-- Hero -->
<div class="hero">
  <h1>Unsafer in Many Turns: Benchmarking and Defending<br/>Multi-Turn Safety Risks in Tool-Using Agents</h1>
  <p class="authors">
    Xu Li<sup>1</sup>,
    Simon Yu<sup>1</sup>,
    Minzhou Pan<sup>1,2</sup>,
    Yiyou Sun<sup>3</sup>,
    Bo Li<sup>4,2</sup>,
    Dawn Song<sup>3,2</sup>,
    Xue Lin<sup>1</sup>,
    Weiyan Shi<sup>1</sup>
  </p>
  <p class="affiliations">
    <sup>1</sup>Northeastern University &nbsp;&nbsp;
    <sup>2</sup>Virtue AI &nbsp;&nbsp;
    <sup>3</sup>University of California, Berkeley &nbsp;&nbsp;
    <sup>4</sup>University of Illinois Urbana-Champaign
  </p>
  <div class="badges">
    <a class="badge" href="#">üìÑ Paper</a>
    <a class="badge" href="#">üíª GitHub</a>
    <a class="badge" href="#">ü§ó Dataset</a>
  </div>
</div>

<!-- Teaser -->
<section>
  <div class="container">
    <h2>Overview</h2>
    <p class="lede">Capability and safety are misaligned for today's agents. Multi-turn interactions expose critical vulnerabilities ‚Äî attack success rates jump 16.1% on average. ToolShield, our training-free defense, reduces ASR by 30% through self-exploration.</p>
    <figure>
      <img src="assets/figures/fig_1_v4.png" alt="Overview figure" class="img-large"/>
      <figcaption>As agents' capabilities grow, their safety lags behind. MT-AgentRisk benchmarks this gap; ToolShield closes it.</figcaption>
    </figure>
  </div>
</section>

<!-- The Gap -->
<section class="tint">
  <div class="container">
    <h2>Why Multi-Turn Agent Safety?</h2>
    <p class="lede">Existing benchmarks test either single-turn tool agents or multi-turn chat ‚Äî never both.</p>
    <table>
      <thead>
        <tr><th>Benchmark</th><th>Multi-Turn</th><th>Tool Usage</th></tr>
      </thead>
      <tbody>
        <tr><td>MHJ</td><td class="yes">‚úì</td><td class="no">‚úó</td></tr>
        <tr><td>SafeDialBench</td><td class="yes">‚úì</td><td class="no">‚úó</td></tr>
        <tr><td>RedTeamCUA</td><td class="no">‚úó</td><td class="yes">‚úì</td></tr>
        <tr><td>SafeArena</td><td class="no">‚úó</td><td>Browser only</td></tr>
        <tr><td>OpenAgentSafety</td><td>‚úó*</td><td class="yes">‚úì</td></tr>
        <tr><td>MCP-Safety</td><td class="no">‚úó</td><td class="yes">‚úì</td></tr>
        <tr class="row-ours"><td>MT-AgentRisk (Ours)</td><td class="yes">‚úì</td><td class="yes">‚úì</td></tr>
      </tbody>
    </table>
  </div>
</section>

<!-- Taxonomy -->
<section>
  <div class="container">
    <h2>Multi-Turn Attack Taxonomy</h2>
    <p class="lede">A principled taxonomy that decomposes single-turn harmful tasks into multi-turn attack sequences across 3 dimensions:</p>
    <p class="dim"><strong>Format:</strong> How the transformation is structured (Addition vs. Decomposition)</p>
    <p class="dim"><strong>Method:</strong> How it is performed (Mapping, Wrapping, Composition, Identity)</p>
    <p class="dim"><strong>Target:</strong> What is manipulated (Data Files vs. Environment States)</p>
    <p style="color:#666; font-size:0.9rem; margin-top:12px;">This yields 8 attack subcategories, preserving the same harmful objective across multiple benign-appearing turns.</p>
    <figure>
      <img src="assets/figures/Taxonomy.png" alt="Taxonomy diagram" class="img-large"/>
      <figcaption>Multi-Turn Attack Taxonomy (MAT): format √ó method √ó target.</figcaption>
    </figure>
  </div>
</section>

<!-- Benchmark & Results -->
<section class="tint">
  <div class="container">
    <h2>Benchmark & Results</h2>
    <div class="stats-row">
      <div class="stat"><div class="val">365</div><div class="label">Tasks</div></div>
      <div class="stat"><div class="val">5</div><div class="label">Tools</div></div>
      <div class="stat"><div class="val">3.19</div><div class="label">Avg Turns</div></div>
      <div class="stat"><div class="val">8</div><div class="label">Attack Types</div></div>
    </div>

    <h2 style="margin-top:40px;">Supported Tools</h2>
    <div class="tools-grid">
      <div class="tool-card">
        <div class="icon">üìÅ</div>
        <div class="name">Filesystem-MCP</div>
        <div class="source">OpenAgentSafety</div>
        <div class="count">70 tasks</div>
      </div>
      <div class="tool-card">
        <div class="icon">üåê</div>
        <div class="name">Playwright-MCP</div>
        <div class="source">SafeArena & OpenAgentSafety</div>
        <div class="count">140 tasks</div>
      </div>
      <div class="tool-card">
        <div class="icon">üíª</div>
        <div class="name">Terminal</div>
        <div class="source">OpenAgentSafety</div>
        <div class="count">70 tasks</div>
      </div>
      <div class="tool-card">
        <div class="icon">üóÑÔ∏è</div>
        <div class="name">PostgreSQL-MCP</div>
        <div class="source">P2SQL</div>
        <div class="count">70 tasks</div>
      </div>
      <div class="tool-card">
        <div class="icon">üìù</div>
        <div class="name">Notion-MCP</div>
        <div class="source">MCPMark</div>
        <div class="count">15 tasks</div>
      </div>
    </div>

    <div class="findings">
      <p>All models show safety degradation in multi-turn settings, with <strong>ASR rising 16.1% on average</strong>.</p>
      <p><strong>Claude-4.5-Sonnet degrades the most (+27.1%)</strong>, revealing critical vulnerability behind multi-turn interactions.</p>
      <p><strong>Stronger capability ‚â† better safety</strong> ‚Äî DeepSeek-v3.2 tops capability benchmarks but shows 85.4% ASR.</p>
    </div>
    <figure>
      <img src="assets/figures/vulnerability_grouped_bar.png" alt="Single vs multi-turn ASR" class="img-medium"/>
      <figcaption>Safety degradation from single-turn to multi-turn settings across models.</figcaption>
    </figure>
  </div>
</section>

<!-- ToolShield Method -->
<section>
  <div class="container">
    <h2>ToolShield: Self-Exploration Defense</h2>
    <p class="lede">A training-free, tool-agnostic defense. When encountering a new tool, the agent:</p>
    <ol class="steps">
      <li><strong>Generates</strong> test cases through structured risk reasoning</li>
      <li><strong>Executes</strong> them in a sandbox to observe behavior</li>
      <li><strong>Distills</strong> safety experiences from execution traces</li>
      <li><strong>Applies</strong> experiences during deployment</li>
    </ol>
    <p style="color:#666; font-size:0.9rem; margin-top:12px;">No weight updates. No tool-specific engineering. Just leveraging the agent's own capability to learn safe behavior.</p>
    <figure>
      <img src="assets/figures/pipeline.png" alt="ToolShield pipeline" class="img-large"/>
      <figcaption>ToolShield self-exploration pipeline: synthesize ‚Üí execute ‚Üí distill ‚Üí deploy.</figcaption>
    </figure>
  </div>
</section>

<!-- ToolShield Results -->
<section class="tint">
  <div class="container">
    <h2>ToolShield Results</h2>
    <div class="findings">
      <p>Reduces ASR by <strong>30% on average</strong> across multi-turn interactions.</p>
      <p><strong>Claude-4.5-Sonnet:</strong> ASR drops from 72% ‚Üí 22% (‚àí50%).</p>
      <p><strong>Zero false positives</strong> on 170 benign tasks.</p>
    </div>

    <div class="two-col">
      <figure>
        <img src="assets/figures/defense_asr_comparison.png" alt="Defense ASR comparison"/>
        <figcaption>Defense effectiveness across models.</figcaption>
      </figure>
      <figure>
        <img src="assets/figures/asr_drop_combined_heatmap.png" alt="Transfer heatmap"/>
        <figcaption>Cross-model transferability of safety experiences.</figcaption>
      </figure>
    </div>

    <figure>
      <img src="assets/figures/tool_effect_asr.png" alt="Tool-wise effect" class="img-medium"/>
      <figcaption>Tool-agnostic: consistent improvements across all tool categories.</figcaption>
    </figure>
  </div>
</section>

<!-- Case Study -->
<section>
  <div class="container">
    <h2>Case Study</h2>
    <p class="lede">Addition-based attack (Wrapping √ó Data). The agent refuses the single-turn request but completes the harmful task when decomposed into multi-turn. With ToolShield, the agent recognizes the distributed harm pattern and refuses.</p>
    <figure>
      <img src="assets/figures/Case_Study_1.png" alt="Case study example" class="case-study-img"/>
      <figcaption>Case study: Addition-based attack (Wrapping √ó Data). The agent refuses the single-turn request but completes the harmful task when decomposed into multi-turn. With ToolShield, the agent recognizes the distributed harm pattern and refuses.</figcaption>
    </figure>
  </div>
</section>

<!-- Cost -->
<section class="tint">
  <div class="container">
    <h2>Cost-Effective Safety</h2>
    <p class="lede">ToolShield's self-exploration is a one-time investment. Defense effectiveness scales with cost.</p>
    <div class="findings">
      <p><strong>Claude-4.5-Sonnet:</strong> Highest improvement (50% ASR reduction) at $204.</p>
      <p><strong>Seed-1.6:</strong> Best cost-effectiveness ‚Äî 38% improvement at just $13.</p>
    </div>
    <figure>
      <img src="assets/figures/cost_vs_safety_improvement_6models.png" alt="Cost vs ASR reduction" class="img-large"/>
      <figcaption>Defense effectiveness vs. self-exploration cost.</figcaption>
    </figure>
  </div>
</section>

<!-- Citation -->

<footer>MT-AgentRisk / ToolShield &nbsp;¬∑&nbsp; 2026</footer>

</body>
</html>