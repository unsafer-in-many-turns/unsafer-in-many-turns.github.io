<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>MT-AgentRisk / ToolShield</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet"/>
  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body { font-family:'Inter',sans-serif; color:#222; line-height:1.6; }
    a { color:#1a6dd4; text-decoration:none; }
    a:hover { text-decoration:underline; }

    .container { max-width:860px; margin:0 auto; padding:0 24px; }

    /* Hero */
    .hero { text-align:center; padding:70px 24px 50px; background:#1a1a2e; color:#fff; }
    .hero .project-name { font-size:1.1rem; color:#aaa; margin-bottom:8px; letter-spacing:1px; }
    .hero h1 { font-size:2.2rem; margin-bottom:20px; line-height:1.3; font-weight:600; }
    .hero .authors { font-size:1rem; color:#ddd; margin-bottom:10px; line-height:1.8; }
    .hero .authors sup { font-size:0.7em; color:#aaa; }
    .hero .affiliations { font-size:0.9rem; color:#aaa; margin-bottom:28px; line-height:1.8; }
    .badges { display:flex; gap:12px; justify-content:center; flex-wrap:wrap; }
    .badge { display:inline-flex; align-items:center; gap:6px; background:#2a2a4a; color:#fff; padding:8px 16px; border-radius:6px; font-size:0.9rem; }
    .badge:hover { background:#3a3a5a; text-decoration:none; }

    /* Sections */
    section { padding:48px 0; }
    section.tint { background:#f7f8fa; }
    h2 { font-size:1.5rem; margin-bottom:12px; }
    h3 { font-size:1.15rem; margin-bottom:12px; color:#222; margin-top:32px; }
    p { margin-bottom:16px; color:#444; }
    p:last-child { margin-bottom:0; }
    .lede { color:#555; margin-bottom:24px; }

    /* Figures */
    figure { margin:24px 0; }
    figure img { width:100%; border:1px solid #e0e0e0; border-radius:4px; }
    figure.small img { width:75%; margin:0 auto; display:block; }
    figcaption { font-size:0.85rem; color:#666; margin-top:6px; text-align:center; }

    /* Two column figures */
    .two-col { display:grid; grid-template-columns:1fr 1fr; gap:24px; align-items: center; }
    .two-col figure { margin:0; }
    @media(max-width:640px){ .two-col { grid-template-columns:1fr; } }

    /* Highlight box for new overview section */
    .highlight-box {
      background: linear-gradient(135deg, #f8f9ff 0%, #fff 100%);
      border: 1px solid #e0e4f0;
      border-radius: 12px;
      padding: 32px;
      margin: 28px 0;
    }
    .highlight-box .two-col {
      align-items: start;
      gap: 32px;
    }
    .highlight-box figure {
      display: flex;
      flex-direction: column;
    }
    .highlight-box .fig-title {
      font-size: 1.05rem;
      font-weight: 600;
      color: #333;
      margin-bottom: 16px;
      line-height: 1.4;
      height: 75px;
      display: flex;
      align-items: flex-start;
    }
    .highlight-box figure img {
      width: 100%;
      height: 380px;
      object-fit: contain;
      border: 1px solid #ddd;
      border-radius: 6px;
      background: #fff;
    }

    /* Video */
    .video-wrapper {
      position: relative;
      padding-bottom: 56.25%;
      height: 0;
      overflow: hidden;
      border: 1px solid #e0e0e0;
      border-radius: 4px;
    }
    .video-wrapper iframe {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }

    /* Table */
    table { width:100%; border-collapse:collapse; margin:16px 0; font-size:0.9rem; }
    table.small { width:75%; margin:16px auto; }
    th, td { padding:8px 12px; border:1px solid #ddd; text-align:center; }
    th { background:#f0f0f0; font-weight:600; }
    td:first-child { text-align:left; }
    .row-ours { background:#e8f4fd; font-weight:600; }
    .yes { color:#16a34a; }
    .no { color:#dc2626; }

    /* Steps */
    ol.steps { padding-left:20px; margin:16px 0; }
    ol.steps li { margin-bottom:6px; }

    /* Tools inline */
    .tools-list { margin:20px 0; }
    .tools-list span { display:inline-block; background:#f0f0f0; padding:4px 10px; border-radius:4px; margin:4px 4px 4px 0; font-size:0.85rem; }

    /* Code snippet */
    .code-block {
      background:#1a1a2e;
      border-radius:8px;
      padding:20px 24px;
      margin:20px 0;
      overflow-x:auto;
      position:relative;
    }
    .code-block .code-header {
      display:flex;
      align-items:center;
      justify-content:space-between;
      margin-bottom:12px;
    }
    .code-block .code-label {
      font-size:0.8rem;
      color:#888;
      font-family:'Inter',sans-serif;
      letter-spacing:0.5px;
    }
    .code-block .code-link {
      font-size:0.8rem;
      color:#7eb8ff;
      text-decoration:none;
      font-family:'Inter',sans-serif;
    }
    .code-block .code-link:hover { text-decoration:underline; }
    .code-block pre {
      margin:0;
      color:#e0e0e0;
      font-size:0.85rem;
      line-height:1.6;
      white-space:pre-wrap;
    }
    .code-block pre .comment { color:#6a9955; }
    .code-block pre .cmd { color:#dcdcaa; }
    .code-block pre .flag { color:#9cdcfe; }
    .code-block pre .value { color:#ce9178; }

    /* Dataset link */
    .dataset-link {
      display:inline-flex;
      align-items:center;
      gap:6px;
      background:#fff;
      border:1px solid #e0e0e0;
      padding:6px 14px;
      border-radius:6px;
      font-size:0.85rem;
      color:#333;
      text-decoration:none;
      margin-top:8px;
      transition:all 0.2s;
    }
    .dataset-link:hover { border-color:#1a6dd4; color:#1a6dd4; text-decoration:none; }

    /* BibTeX */
    pre.bib { background:#f0f0f0; padding:16px; border-radius:6px; font-size:0.8rem; overflow-x:auto; white-space:pre-wrap; }

    /* Footer */
    footer { text-align:center; padding:24px; color:#999; font-size:0.85rem; border-top:1px solid #eee; }
  </style>
</head>
<body>

<!-- Hero -->
<div class="hero">
  <p class="project-name">MT-AgentRisk / ToolShield</p>
  <h1>Unsafer in Many Turns: Benchmarking and Defending<br/>Multi-Turn Safety Risks in Tool-Using Agents</h1>
  <p class="authors">
    Xu Li<sup>1</sup>, Simon Yu<sup>1</sup>, Minzhou Pan<sup>1,2</sup>, Yiyou Sun<sup>3</sup>, Bo Li<sup>4,2</sup>, Dawn Song<sup>3,2</sup>, Xue Lin<sup>1</sup>, Weiyan Shi<sup>1</sup>
  </p>
  <p class="affiliations">
    <sup>1</sup>Northeastern University &nbsp;
    <sup>2</sup>Virtue AI &nbsp;
    <sup>3</sup>UC Berkeley &nbsp;
    <sup>4</sup>UIUC
  </p>
  <div class="badges">
    <a class="badge" href="#">üìÑ Paper</a>
    <a class="badge" href="https://github.com/CHATS-lab/MT-AgentRisk_ToolShield">üíª GitHub</a>
    <a class="badge" href="https://huggingface.co/datasets/CHATS-Lab/MT-AgentRisk">ü§ó Dataset</a>
    <a class="badge" href="https://www.notion.so/Unsafer-in-Many-Turns-Benchmarking-and-Defending-Multi-Turn-Safety-Risks-in-Tool-Using-Agents-30102b8c305b80dfb65de3cec21db4a3?source=copy_link">üìù Blog</a>
    <a class="badge" href="leader_board.html">üèÜ Leaderboard</a>
  </div>
</div>

<!-- Overview & Why -->
<section>
  <div class="container">
    <!-- Highlight box with two figures -->
    <div class="highlight-box">
      <div class="two-col">
        <figure>
          <p class="fig-title">Multi-turn interactions and tool usage amplifies agent utility. But the intersections introduce new risk interfaces overlooked by existing benchmarks.</p>
          <img src="assets/figures/Multi_Turn_Case.png" alt="Multi-turn case study"/>
        </figure>
        <figure>
          <p class="fig-title">Can agents use their own capability to improve safety awareness?<br/><strong style="color:#16a34a;">Yes!</strong></p>
          <img src="assets/figures/defense_asr_decrease_horizontal.png" alt="Defense ASR decrease"/>
        </figure>
      </div>
    </div>
  </div>
</section>

<!-- Taxonomy & Benchmark -->
<section class="tint">
  <div class="container">
    <h2>MT-AgentRisk Benchmark</h2>
    
    <h3>Multi-Turn Attack Taxonomy (MTA)</h3>
    <p>Existing benchmarks focus on either single-turn tool-using agents or multi-turn conversations without tools, overlooking the complex interplay between tool-use and multi-turn dynamics. To systematically study this intersection, we propose an attack taxonomy that captures how single-turn harms can be distributed across turns. The taxonomy operates along three dimensions: how the transformation is structured (<strong>Format</strong>), how it is performed (<strong>Method</strong>), and what is manipulated (<strong>Target</strong>), yielding 8 attack subcategories.</p>
    <figure>
      <img src="assets/figures/taxonomy.png" alt="Taxonomy diagram"/>
      <figcaption>Multi-Turn Attack Taxonomy: transforming single-turn harms into multi-turn sequences.</figcaption>
    </figure>

    <h3>Benchmark Statistics</h3>
    <p>Apply MTA on existing single-turn harmful tasks, <strong>MT-AgentRisk</strong> contains 365 tasks across 5 tools, averaging 3.19 turns per task, covering all 8 attack subcategories.</p>
    <div class="tools-list">
      <span>üìÅ Filesystem-MCP (70)</span>
      <span>üåê Playwright-MCP (140)</span>
      <span>üíª Terminal (70)</span>
      <span>üóÑÔ∏è PostgreSQL-MCP (70)</span>
      <span>üìù Notion-MCP (15)</span>
    </div>
    <p style="font-size:0.85rem; color:#666;">Sources: OpenAgentSafety, SafeArena, P2SQL, MCPMark</p>
    <a href="https://huggingface.co/datasets/CHATS-Lab/MT-AgentRisk" class="dataset-link">ü§ó Download on Hugging Face</a>
  </div>
</section>

<!-- Results -->
<section>
  <div class="container">
    <h2>How Vulnerable Are Agents Under Multi-Turn Interactions?</h2>
    <p class="lede">All models show safety degradation in multi-turn settings. Attack Success Rate (ASR) increases by <strong>16.1% on average</strong>, with Claude-4.5-Sonnet showing the largest jump (+27.1%). Notably, stronger capability does not imply better safety: DeepSeek-v3.2 achieves top capability scores among open-source models but exhibits 85.4% ASR.</p>
    <figure class="small">
      <img src="assets/figures/vulnerability_horizontal.png" alt="Single vs multi-turn ASR"/>
      <figcaption>Safety degradation from single-turn to multi-turn settings across models.</figcaption>
    </figure>
  </div>
</section>

<!-- Defense Method -->
<section class="tint">
  <div class="container">
    <h2>How Does ToolShield Utilize Capability to Improve Safety?</h2>
    <p class="lede"><strong>ToolShield</strong> is a training-free, tool-agnostic defense. The key insight is that the same capability that enables tool use also enables recognizing tool misuse. When encountering a new tool, the agent:</p>
    <ol class="steps">
      <li><strong>Synthesizes</strong> test cases through structured risk reasoning</li>
      <li><strong>Executes</strong> them in a sandbox to observe behavior</li>
      <li><strong>Distills</strong> safety experiences from execution traces</li>
      <li><strong>Applies</strong> summarized experiences during deployment</li>
    </ol>
    <figure>
      <img src="assets/figures/pipeline.png" alt="ToolShield pipeline"/>
      <figcaption>ToolShield self-exploration pipeline.</figcaption>
    </figure>

    <div class="code-block">
      <div class="code-header">
        <span class="code-label">Quick Start</span>
        <a class="code-link" href="https://github.com/CHATS-lab/MT-AgentRisk_ToolShield/tree/main">View on GitHub ‚Üí</a>
      </div>
      <pre><span class="comment"># Run the full ToolShield pipeline:</span>
<span class="comment"># Inspect MCP ‚Üí Generate Safety Tree ‚Üí Generate Tests ‚Üí Distill Experiences ‚Üí Inject into Agent Context</span>

<span class="cmd">python</span> self_exploration/toolshield.py \
  <span class="flag">--mcp_name</span> <span class="value">postgres</span> \
  <span class="flag">--mcp_server</span> <span class="value">http://localhost:9091</span> \
  <span class="flag">--output_path</span> <span class="value">/mnt/data/MT-AgentRisk_ToolShield/self_exploration/exp_examples</span> \
  <span class="flag">--agent</span> <span class="value">codex</span></pre>
    </div>
  </div>
</section>

<!-- Defense Results -->
<section>
  <div class="container">
    <h2>Defense Results</h2>
    <p class="lede">ToolShield reduces ASR by <strong>30% on average</strong> across 6 models on multi-turn settings. Claude-4.5-Sonnet shows the largest improvement, dropping from 72% to 22% (‚àí50%). More importantly, the injected experiences introduce <strong>zero false positives</strong> on benign tasks.</p>

    <p><strong>ToolShield is General:</strong> Safety experiences generated by one model can be effectively applied to others. Stronger models benefit from safety experiences generated by weaker models and vice versa.</p>
    <p><strong>ToolShield is Cost-Effective:</strong> ToolShield's self-exploration is a one-time investment. Defense effectiveness scales with cost: Claude-4.5-Sonnet achieves the highest improvement (50% ASR reduction) at $204, while Seed-1.6 offers the best cost-effectiveness with 38% improvement at just $13. However, as shown on the left image, claude can still benefit a lot with the experiences generated using $15 (Gemini-3-Flash)</p>
    <div class="two-col">
      <figure>
        <img src="assets/figures/asr_drop_combined_heatmap.png" alt="Transfer heatmap"/>
        <figcaption>Cross-model transferability of experiences.</figcaption>
      </figure>
      <figure style="text-align: center;">
        <img src="assets/figures/cost_vs_safety_improvement_6models.png" alt="Cost vs ASR reduction" style="width: 70%;"/>
        <figcaption>Defense effectiveness vs. self-exploration cost.</figcaption>
      </figure>
    </div>
  </div>
</section>

<!-- Case Study -->
<section class="tint">
  <div class="container">
    <h2>Case Study</h2>
    <p class="lede">An Addition-based attack (Wrapping √ó Data): the agent refuses the single-turn request but completes the harmful task when decomposed into multiple turns. With ToolShield, the agent recognizes the distributed harm pattern and refuses.</p>
    <figure>
      <div class="video-wrapper">
        <iframe src="https://www.youtube.com/embed/bxpreKe1Vvw" title="MT-AgentRisk Demo" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
      </div>
      <figcaption>Video overview of harmful task state changes.</figcaption>
    </figure>
  </div>
</section>

<!-- Citation -->
<section>
  <div class="container">
    <h2>Citation</h2>
  </div>
</section>

<footer>MT-AgentRisk / ToolShield ¬∑ 2026</footer>

</body>
</html>